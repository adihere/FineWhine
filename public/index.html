<!DOCTYPE html>
<!--
To change this license header, choose License Headers in Project Properties.
To change this template file, choose Tools | Templates
and open the template in the editor.
-->
<html>
    <head>
        <link rel="stylesheet" href="indexTable.css" type="text/css"/>
        <link rel="stylesheet" href="indexTable.css" type="text/css">
		<script type="text/javascript" src="../jquery-3.2.1.js"></script>

        <title>Fine Whine matrix</title>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
    </head>
    
    <body>
      
<style>
	.demo {
		border:1px double #2B2B55;
		border-collapse:collapse;
		padding:5px;
	}
	.demo th {
		border:1px double #2B2B55;
		padding:5px;
		background:#FFFFE8;
	}
	.demo td {
		border:1px double #2B2B55;
		padding:5px;
	}
</style>

<table class = "demo" id = "fwtable">
	<caption>State of DevOps and Engineering </caption>
	<thead>
	<tr>
		<th>Theme </th>
		<th>Key Indicator</th>
		<th>Score</th>
		<th>L1-Early days </th>
		<th>L2-Well defined</th>
		<th>L3-Adoption in progress</th>
		<th>L4-Optimised Karma</th>
	</tr>
	</thead>
	<tbody>
	<tr>
		<td>&nbsp;Culture</td>
		<td>&nbsp;Leadership is supportive</td>
		<td class = "score1"> &nbsp;</td>
		<td>not aware&nbsp;</td>
		<td>pay lip service&nbsp;</td>
		<td>&nbsp;pockets of support</td>
		<td>at least 75% committed and involved in directly sponsoring initiatives&nbsp;</td>
	</tr>
	<tr>
		<td>&nbsp;Culture</td>
		<td>&nbsp;Culture of Innovation and learning&nbsp;</td>
		<td class = "score2" > &nbsp;</td>
		<td>&nbsp;silos</td>
		<td>&nbsp;pockets of change</td>
		<td>&nbsp;at least 50% of portfolios have adopted new ways of working</td>
		<td>at least 80% adoption rate</td>
	</tr>
	<tr>
		<td>&nbsp;Engineering&nbsp;</td>
		<td>&nbsp;Test automation</td>
		<td class = "score3" > &nbsp;</td>
		<td>&nbsp;what?</td>
		<td>&nbsp;some teams have started focusing on  test automation</td>
		<td>&nbsp;at least 30% consistent automation coverage across teams</td>
		<td>&nbsp;at least 60% coverage across the landscape</td>
	</tr>
	<tr>
		<td>&nbsp;Engineering&nbsp;</td>		
		<td>&nbsp;Modern Development practices</td>
		<td class = "score4" > &nbsp;</td>
        <td>&nbsp;primitive ways</td>
		<td>&nbsp;some modern techniques being explored</td>
		<td>&nbsp;at least 30% consistent application of engineering practices such as TDD</td>
		<td>&nbsp;&nbsp;at least 80% consistent application of engineering practices such as TDD</td>
	</tr>
	<tr>
		<td>&nbsp;Release</td>
		<td>&nbsp;Release frequency&nbsp;</td>
		<td class = "score5" > &nbsp;</td>
		<td>&nbsp;yearly</td>
		<td>&nbsp;quarterly</td>
		<td>&nbsp;monthly</td>
		<td>&nbsp;weekly</td>
	</tr>
	<tr>
		<td>&nbsp;Quality&nbsp;</td>
		<td>&nbsp;Ownership of quality&nbsp;</td>
		<td class = "score6"> &nbsp;</td>
		<td>&nbsp;testing problem</td>
		<td>&nbsp;team problem</td>
		<td>&nbsp;developers own quality</td>
		<td>genuine quality first thinking from top to bottom</td>
	</tr>
	<tbody>
</table>
</body>


<script type="text/javascript">

window.addEventListener('load', function () {

	$(document).ready(function() {
		console.log("jquery 1");

		$('td').click(function() {		
			var myCol = $(this).index();
		    var $tr = $(this).closest('tr');
		    //console.log("jquery data row number: dump of this "+ this);
		    var myRow = $tr.index();
		
			if (myCol > 2) { 
	   			console.log("jquery data row number: " + myRow + "column number:  "+ myCol +"dump of this: "+this);
	   			$(this).css("font-weight","bold");
	   			$( this ).css( "color", "red" );
				setScore(myRow,myCol);
			}
	
		});
   			//$('tr#fwtable td').innerHtml = "";
	});

		
});



function setScore( nRow, nCol) {

				switch((nRow+1)) {
					case 1:
						$('#fwtable td.score1').html((nCol-2)) ;
					    break;
					case 2:
						$('#fwtable td.score2').html((nCol-2)) ;
					    break;
					case 3:
						$('#fwtable td.score3').html((nCol-2)) ;
					    break;
					case 4:
						$('#fwtable td.score4').html((nCol-2)) ;
					    break;
					case 5:
					    $('#fwtable td.score5').html((nCol-2)) ;
					    break;				
					case 6:
						$('#fwtable td.score6').html((nCol-2)) ;
					    break;

					default:
					    console.log("from default");
				}


}

/*Reserve
$(document).ready(function() {
		console.log("inside jqery test");
		 $("#msgid").html("This is Hello World for JQuery - Remove me when done!!");
	});
*/

	
function updateDb (e) {
	
	var lock = LockService.getPublicLock();
	lock.waitLock(30000);  // wait 30 seconds before conceding defeat.

	 try {

	    // next set where we write the data - you could write to multiple/alternate destinations
		var gdoc = SpreadgsheetApp.openById("1ThppsMYaxkd9_gRGqTI1X-2cBJk3qhck9ooIfDH-VDU");
		var gsheetname = "gsheet1";
		var gsheet = gdoc.getgsheetByName(gsheetname);
	    
	    // we'll assume header is in row 1 but you can override with header_row in GET/POST data
	    //var headRow = e.parameter.header_row || 1;  //repalce with data from html data 
	    var headers = gsheet.getRange(1, 1, 1, gsheet.getLastColumn()).getValues()[0];
	    var nextRow = gsheet.getLastRow()+1; // get next row
	    var row = []; 

	    // loop through the header columns
	    for (i in headers){
	      if (headers[i] == "Timestamp"){ // special case if you include a 'Timestamp' column
	        row.push(new Date());
	      } else { // else use header name to get data
	        row.push(e.parameter[headers[i]]);
	      }
	    }
		
		// more efficient to set values as [][] array than individually
	    gsheet.getRange(nextRow, 1, 1, row.length).setValues([row]);
	    // return json success results
	    return ContentService
	          .createTextOutput(JSON.stringify({"result":"success", "row": nextRow}))
	          .setMimeType(ContentService.MimeType.JSON);
	} 
	
	catch(e){
		// if error return this
		return ContentService
	      .createTextOutput(JSON.stringify({"result":"error", "error": e}))
	      .setMimeType(ContentService.MimeType.JSON);
		} 
	
		finally { //release lock
		lock.releaseLock();
		}

}


</script>

    
</html>
